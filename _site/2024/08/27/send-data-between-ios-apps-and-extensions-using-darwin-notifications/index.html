<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/images/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/images/favicons/favicon-16x16.png">
    <link rel="manifest" href="/blog/assets/images/favicons/site.webmanifest">
    <link rel="mask-icon" href="/blog/assets/images/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#9f00a7">
    <meta name="theme-color" content="#ffffff">
    <!-- <link href="https://newsletter.codeflakes.studio/public/static/style.css" rel="stylesheet" type="text/css">
    <link href="https://newsletter.codeflakes.studio/public/custom.css" rel="stylesheet" type="text/css">
    <link href="https://newsletter.codeflakes.studio/public/custom.js" rel="stylesheet" type="text/css"> -->
    
    <!-- Bulma CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.3/css/bulma.min.css" media="print" onload="this.media='all'">
    <noscript>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.3/css/bulma.min.css">
    </noscript>
      
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" media="print" onload="this.media='all'">
    <noscript>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    </noscript>

  
    <!-- AOS.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.1/aos.css"/>
  
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
    
  
    
    
    
    <title>Send data Between iOS Apps and Extensions Using Darwin Notifications</title>
    <meta name="description" content="In iOS development, app extensions run in separate processes from their containing apps. This separation poses a challenge when you need to communicate between the main app and its extensions. While NSNotificationCenter is a common choice for passing data between view controllers within the same app, it falls short when it comes to inter-process communication. Have you ever thought about how to pass data between the main app and its extension? Darwin notifications provide a powerful solution for this scenario. In this post, we’ll explore how to implement a Darwin Notifications manager and use it to facilitate real-time data transfer between a main app and its extension.">
    
      
      <meta name="keywords" content="swift,xcode,darwin notifications,notifications,send data between app and extension,CFNotificationCenterGetDarwinNotifyCenter,CFNotificationCenterAddObserver,DarwinNotificationManager,CFNotificationCenter">
    
  
    <link rel="stylesheet" href="/blog/assets/main.css">
    <link rel="stylesheet" href="/blog/assets/css/fonts.css">
    <link rel="stylesheet" href="/blog/assets/css/customstyles.css">
    <link rel="stylesheet" href="/blog/assets/css/custom_image.css">

 
    <link rel="canonical" href="https://ohmyswift.com/blog/2024/08/27/send-data-between-ios-apps-and-extensions-using-darwin-notifications/">
    
    
    <link rel="alternate" type="application/rss+xml" title="OhMySwift" href="https://ohmyswift.com/blog/feed.xml">
  
    
  
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6606434168907131"
     crossorigin="anonymous"></script>
    
  
  
    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-144905716-1', 'auto');
      ga('send', 'pageview');
    </script>
  


    <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-3SC6RS0VBR"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-3SC6RS0VBR');
</script>
    <script type="text/javascript" id="zohoapptics">var d=document,s=d.createElement("script");s.type="text/javascript";s.id="zohoappticsscript";s.defer=!0;s.src="https://apptics.zoho.in/sdk/web/v1/60040795023/645000000002061/init?aaID=645000000002073";var t=d.getElementsByTagName("script")[0];t.parentNode.insertBefore(s,t);window.appticsReady=function(s){var e=window.apptics__asyncalls=window.apptics__asyncalls||[];window.appticsReadyStatus?(s&&e.push(s),e.forEach(s=>s&&s()),window.apptics__asyncalls=null):s&&e.push(s)};</script>

   
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Send data Between iOS Apps and Extensions Using Darwin Notifications | OhMySwift</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Send data Between iOS Apps and Extensions Using Darwin Notifications" />
<meta name="author" content="Rizwan Ahmed A" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In iOS development, app extensions run in separate processes from their containing apps. This separation poses a challenge when you need to communicate between the main app and its extensions. While NSNotificationCenter is a common choice for passing data between view controllers within the same app, it falls short when it comes to inter-process communication. Have you ever thought about how to pass data between the main app and its extension? Darwin notifications provide a powerful solution for this scenario. In this post, we’ll explore how to implement a Darwin Notifications manager and use it to facilitate real-time data transfer between a main app and its extension." />
<meta property="og:description" content="In iOS development, app extensions run in separate processes from their containing apps. This separation poses a challenge when you need to communicate between the main app and its extensions. While NSNotificationCenter is a common choice for passing data between view controllers within the same app, it falls short when it comes to inter-process communication. Have you ever thought about how to pass data between the main app and its extension? Darwin notifications provide a powerful solution for this scenario. In this post, we’ll explore how to implement a Darwin Notifications manager and use it to facilitate real-time data transfer between a main app and its extension." />
<link rel="canonical" href="https://ohmyswift.com/blog/2024/08/27/send-data-between-ios-apps-and-extensions-using-darwin-notifications/" />
<meta property="og:url" content="https://ohmyswift.com/blog/2024/08/27/send-data-between-ios-apps-and-extensions-using-darwin-notifications/" />
<meta property="og:site_name" content="OhMySwift" />
<meta property="og:image" content="https://ohmyswift.com/blog/assets/images/darwin/facebook.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-08-27T13:43:00-05:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://ohmyswift.com/blog/assets/images/darwin/twitter.png" />
<meta property="twitter:title" content="Send data Between iOS Apps and Extensions Using Darwin Notifications" />
<script type="application/ld+json">
{"url":"https://ohmyswift.com/blog/2024/08/27/send-data-between-ios-apps-and-extensions-using-darwin-notifications/","author":{"@type":"Person","name":"Rizwan Ahmed A"},"image":{"twitter":"assets/images/darwin/twitter.png","facebook":"assets/images/darwin/facebook.png","url":"https://ohmyswift.com/blog/assets/images/darwin/facebook.png","@type":"imageObject"},"headline":"Send data Between iOS Apps and Extensions Using Darwin Notifications","dateModified":"2024-08-27T13:43:00-05:00","datePublished":"2024-08-27T13:43:00-05:00","description":"In iOS development, app extensions run in separate processes from their containing apps. This separation poses a challenge when you need to communicate between the main app and its extensions. While NSNotificationCenter is a common choice for passing data between view controllers within the same app, it falls short when it comes to inter-process communication. Have you ever thought about how to pass data between the main app and its extension? Darwin notifications provide a powerful solution for this scenario. In this post, we’ll explore how to implement a Darwin Notifications manager and use it to facilitate real-time data transfer between a main app and its extension.","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://ohmyswift.com/blog/2024/08/27/send-data-between-ios-apps-and-extensions-using-darwin-notifications/"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->




</head>
  

  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/blog/">OhMySwift</a>

    <nav class="site-nav">
      
        
        <a class="page-link" href="/blog/archives/">Archives</a>
      
        
        <a class="page-link" href="/blog/talks/">Talks & Workshops</a>
      
        
        <a class="page-link" href="/blog/social/">Let's Connect</a>
      
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    
      <h1 class="post-title" itemprop="name headline">Send data Between iOS Apps and Extensions Using Darwin Notifications</h1>
    
    <p class="post-meta"><time datetime="2024-08-27T13:43:00-05:00" itemprop="datePublished">Aug 27, 2024</time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Rizwan Ahmed A</span></span> •
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/blog/categories/notifications/">notifications</a>
      
    
  


 •
  
    
    
      
        <a href="/blog/tags/swift/">swift</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/blog/tags/xcode/">xcode</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/blog/tags/xcode16/">xcode16</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/blog/tags/darwin-notifications/">darwin notifications</a>,
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="/blog/tags/cfnotificationcenter/">CFNotificationCenter</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

</p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>In iOS development, app extensions run in separate processes from their containing apps. This separation poses a challenge when you need to communicate between the main app and its extensions. While <code class="language-plaintext highlighter-rouge">NSNotificationCenter</code> is a common choice for passing data between view controllers within the same app, it falls short when it comes to inter-process communication. Have you ever thought about how to pass data between the main app and its extension? Darwin notifications provide a powerful solution for this scenario. In this post, we’ll explore how to implement a Darwin Notifications manager and use it to facilitate real-time data transfer between a main app and its extension.</p>

<h2 id="what-are-darwin-notifications-aka-cfnotificationcentergetdarwinnotifycenter">What are Darwin Notifications a.k.a CFNotificationCenterGetDarwinNotifyCenter?</h2>

<p><code class="language-plaintext highlighter-rouge">CFNotificationCenterGetDarwinNotifyCenter</code> is a function in Apple’s Core Foundation framework that provides access to the Darwin Notification Center. This notification center is designed for system-wide notifications, allowing different processes (such as your app and its extensions) to communicate with each other.</p>

<h2 id="how-does-it-work">How Does it Work?</h2>

<p><strong>System-Wide Communication:</strong> Unlike NSNotificationCenter, which is limited to the app’s process, the Darwin Notification Center can send notifications that can be observed by other processes on the device. This makes it ideal for app-to-extension communication.</p>

<p><strong>No UserInfo Dictionary:</strong> One limitation is that Darwin notifications do not support sending additional data (like a userInfo dictionary). This means you can only send a simple notification without any extra information. This is because the underlying mechanism, notify_post(), only accepts a string identifier for the notification</p>

<h2 id="a-use-case-for-darwin-notifications">A use case for Darwin Notifications</h2>

<p>For example, when a broadcast upload extension starts or stops, you can use a Darwin notification to inform the main app. I have seen most of the people use UserDefaults or the Keychain but I personally feel that Darwin notifications are the best fit for this use case.</p>

<h2 id="implementing-the-darwin-notification-manager">Implementing the Darwin Notification Manager</h2>

<p>To start, we’ll create a <code class="language-plaintext highlighter-rouge">DarwinNotificationManager</code> class that uses the <code class="language-plaintext highlighter-rouge">CFNotificationCenter</code> API to post and observe notifications across processes.</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">import</span> <span class="kt">Foundation</span>

<span class="kd">class</span> <span class="kt">DarwinNotificationManager</span> <span class="p">{</span>
    
    <span class="kd">static</span> <span class="k">let</span> <span class="nv">shared</span> <span class="o">=</span> <span class="kt">DarwinNotificationManager</span><span class="p">()</span>
    
    <span class="kd">private</span> <span class="nf">init</span><span class="p">()</span> <span class="p">{}</span>
    
    <span class="c1">// 1</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">callbacks</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">]</span> <span class="o">=</span> <span class="p">[:]</span>
    
    <span class="c1">// Method to post a Darwin notification</span>
    <span class="kd">func</span> <span class="nf">postNotification</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">notificationCenter</span> <span class="o">=</span> <span class="kt">CFNotificationCenterGetDarwinNotifyCenter</span><span class="p">()</span>
        <span class="kt">CFNotificationCenterPostNotification</span><span class="p">(</span><span class="n">notificationCenter</span><span class="p">,</span> <span class="kt">CFNotificationName</span><span class="p">(</span><span class="n">name</span> <span class="k">as</span> <span class="kt">CFString</span><span class="p">),</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">nil</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c1">// 2</span>
    <span class="kd">func</span> <span class="nf">startObserving</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">callback</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
        
        <span class="k">let</span> <span class="nv">notificationCenter</span> <span class="o">=</span> <span class="kt">CFNotificationCenterGetDarwinNotifyCenter</span><span class="p">()</span>
        
        <span class="kt">CFNotificationCenterAddObserver</span><span class="p">(</span><span class="n">notificationCenter</span><span class="p">,</span>
                                        <span class="kt">Unmanaged</span><span class="o">.</span><span class="nf">passUnretained</span><span class="p">(</span><span class="k">self</span><span class="p">)</span><span class="o">.</span><span class="nf">toOpaque</span><span class="p">(),</span>
                                        <span class="kt">DarwinNotificationManager</span><span class="o">.</span><span class="n">notificationCallback</span><span class="p">,</span>
                                        <span class="n">name</span> <span class="k">as</span> <span class="kt">CFString</span><span class="p">,</span>
                                        <span class="kc">nil</span><span class="p">,</span>
                                        <span class="o">.</span><span class="n">deliverImmediately</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c1">// 3</span>
    <span class="kd">func</span> <span class="nf">stopObserving</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">notificationCenter</span> <span class="o">=</span> <span class="kt">CFNotificationCenterGetDarwinNotifyCenter</span><span class="p">()</span>
        <span class="kt">CFNotificationCenterRemoveObserver</span><span class="p">(</span><span class="n">notificationCenter</span><span class="p">,</span> <span class="kt">Unmanaged</span><span class="o">.</span><span class="nf">passUnretained</span><span class="p">(</span><span class="k">self</span><span class="p">)</span><span class="o">.</span><span class="nf">toOpaque</span><span class="p">(),</span> <span class="kt">CFNotificationName</span><span class="p">(</span><span class="n">name</span> <span class="k">as</span> <span class="kt">CFString</span><span class="p">),</span> <span class="kc">nil</span><span class="p">)</span>
        <span class="n">callbacks</span><span class="o">.</span><span class="nf">removeValue</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="n">name</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c1">// 4</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="k">let</span> <span class="nv">notificationCallback</span><span class="p">:</span> <span class="kt">CFNotificationCallback</span> <span class="o">=</span> <span class="p">{</span> <span class="n">center</span><span class="p">,</span> <span class="n">observer</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">observer</span> <span class="o">=</span> <span class="n">observer</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        <span class="k">let</span> <span class="nv">manager</span> <span class="o">=</span> <span class="kt">Unmanaged</span><span class="o">&lt;</span><span class="kt">DarwinNotificationManager</span><span class="o">&gt;.</span><span class="nf">fromOpaque</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span><span class="o">.</span><span class="nf">takeUnretainedValue</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="k">let</span> <span class="nv">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">?</span><span class="o">.</span><span class="n">rawValue</span> <span class="k">as</span> <span class="kt">String</span><span class="p">?,</span> <span class="k">let</span> <span class="nv">callback</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="p">{</span>
            <span class="nf">callback</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h2 id="the-breakdown-of-darwin-notification-manager">The breakdown of Darwin Notification Manager</h2>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">private</span> <span class="k">var</span> <span class="nv">callbacks</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">]</span> <span class="o">=</span> <span class="p">[:]</span></code></pre></figure>

<p>The <code class="language-plaintext highlighter-rouge">callbacks</code> stores callbacks for each notification name to execute when the notification is received.</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">func</span> <span class="nf">startObserving</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">callback</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">callback</span>
    
    <span class="k">let</span> <span class="nv">notificationCenter</span> <span class="o">=</span> <span class="kt">CFNotificationCenterGetDarwinNotifyCenter</span><span class="p">()</span>
    
    <span class="kt">CFNotificationCenterAddObserver</span><span class="p">(</span><span class="n">notificationCenter</span><span class="p">,</span>
                                    <span class="kt">Unmanaged</span><span class="o">.</span><span class="nf">passUnretained</span><span class="p">(</span><span class="k">self</span><span class="p">)</span><span class="o">.</span><span class="nf">toOpaque</span><span class="p">(),</span>
                                    <span class="kt">DarwinNotificationManager</span><span class="o">.</span><span class="n">notificationCallback</span><span class="p">,</span>
                                    <span class="n">name</span> <span class="k">as</span> <span class="kt">CFString</span><span class="p">,</span>
                                    <span class="kc">nil</span><span class="p">,</span>
                                    <span class="o">.</span><span class="n">deliverImmediately</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<p>The <code class="language-plaintext highlighter-rouge">startObserving</code> method registers a callback for a notification and adds an observer to listen for it. Call this method when you want to start observing for notifications. It is usually called when the view is initialized.</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">func</span> <span class="nf">stopObserving</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">notificationCenter</span> <span class="o">=</span> <span class="kt">CFNotificationCenterGetDarwinNotifyCenter</span><span class="p">()</span>
    <span class="kt">CFNotificationCenterRemoveObserver</span><span class="p">(</span><span class="n">notificationCenter</span><span class="p">,</span> <span class="kt">Unmanaged</span><span class="o">.</span><span class="nf">passUnretained</span><span class="p">(</span><span class="k">self</span><span class="p">)</span><span class="o">.</span><span class="nf">toOpaque</span><span class="p">(),</span> <span class="kt">CFNotificationName</span><span class="p">(</span><span class="n">name</span> <span class="k">as</span> <span class="kt">CFString</span><span class="p">),</span> <span class="kc">nil</span><span class="p">)</span>
    <span class="n">callbacks</span><span class="o">.</span><span class="nf">removeValue</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="n">name</span><span class="p">)</span>
<span class="p">}</span></code></pre></figure>

<p>The <code class="language-plaintext highlighter-rouge">stopObserving</code> method removes the observer for a notification and deletes its callback to stop listening.It is usually called when the view gets deallocated.</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">private</span> <span class="kd">static</span> <span class="k">let</span> <span class="nv">notificationCallback</span><span class="p">:</span> <span class="kt">CFNotificationCallback</span> <span class="o">=</span> <span class="p">{</span> <span class="n">center</span><span class="p">,</span> <span class="n">observer</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="k">in</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">observer</span> <span class="o">=</span> <span class="n">observer</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
    <span class="k">let</span> <span class="nv">manager</span> <span class="o">=</span> <span class="kt">Unmanaged</span><span class="o">&lt;</span><span class="kt">DarwinNotificationManager</span><span class="o">&gt;.</span><span class="nf">fromOpaque</span><span class="p">(</span><span class="n">observer</span><span class="p">)</span><span class="o">.</span><span class="nf">takeUnretainedValue</span><span class="p">()</span>
    
    <span class="k">if</span> <span class="k">let</span> <span class="nv">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">?</span><span class="o">.</span><span class="n">rawValue</span> <span class="k">as</span> <span class="kt">String</span><span class="p">?,</span> <span class="k">let</span> <span class="nv">callback</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">callbacks</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="p">{</span>
        <span class="nf">callback</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>The <code class="language-plaintext highlighter-rouge">notificationCallback</code> executes the stored callback when the corresponding notification is received.</p>

<h2 id="using-the-manager-in-a-broadcast-extension">Using the Manager in a Broadcast Extension</h2>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">import</span> <span class="kt">ReplayKit</span>

<span class="kd">class</span> <span class="kt">SampleHandler</span><span class="p">:</span> <span class="kt">RPBroadcastSampleHandler</span> <span class="p">{</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">broadcastStarted</span><span class="p">(</span><span class="n">withSetupInfo</span> <span class="nv">setupInfo</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span> <span class="p">:</span> <span class="kt">NSObject</span><span class="p">]?)</span> <span class="p">{</span>
        <span class="kt">DarwinNotificationManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">postNotification</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"com.yourapp.BroadcastStarted"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">broadcastFinished</span><span class="p">()</span> <span class="p">{</span>
        <span class="kt">DarwinNotificationManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">postNotification</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"com.yourapp.BroadcastStopped"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h2 id="observing-the-darwin-notifications-in-a-uikit-view">Observing the Darwin Notifications in a UIKit View</h2>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">class</span> <span class="kt">DashboardViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span> 
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewWillAppear</span><span class="p">(</span><span class="n">_</span> <span class="nv">animated</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewWillAppear</span><span class="p">(</span><span class="n">animated</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">configureCallbacks</span><span class="p">()</span>
    <span class="p">}</span>


    <span class="kd">fileprivate</span> <span class="kd">func</span> <span class="nf">configureCallbacks</span><span class="p">()</span> <span class="p">{</span>
        <span class="kt">DarwinNotificationManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">startObserving</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"com.yourapp.BroadcastStarted"</span><span class="p">)</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"*******Broadcast has started*******"</span><span class="p">)</span>
            <span class="c1">// Handle the event when broadcast starts</span>
        <span class="p">}</span>
        
        <span class="kt">DarwinNotificationManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">startObserving</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"com.yourapp.BroadcastStopped"</span><span class="p">)</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"*******Broadcast has stopped*******"</span><span class="p">)</span>
            <span class="c1">// Handle the event when broadcast starts</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h2 id="observing-the-darwin-notifications-in-a-swiftui-view">Observing the Darwin Notifications in a SwiftUI View</h2>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">import</span> <span class="kt">SwiftUI</span>
<span class="kd">import</span> <span class="kt">Foundation</span>

<span class="kd">struct</span> <span class="kt">BroadcastView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kd">@State</span> <span class="kd">private</span> <span class="k">var</span> <span class="nv">broadcastStatus</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">"Not Broadcasting"</span>
    
    <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">VStack</span> <span class="p">{</span>
            <span class="kt">Text</span><span class="p">(</span><span class="n">broadcastStatus</span><span class="p">)</span>
                <span class="o">.</span><span class="nf">font</span><span class="p">(</span><span class="o">.</span><span class="n">largeTitle</span><span class="p">)</span>
                <span class="o">.</span><span class="nf">padding</span><span class="p">()</span>
        
        <span class="p">}</span>
        <span class="o">.</span><span class="n">onAppear</span> <span class="p">{</span>
            <span class="nf">configureCallbacks</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="o">.</span><span class="n">onDisappear</span> <span class="p">{</span>
            <span class="nf">stopCallbacks</span><span class="p">()</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">configureCallbacks</span><span class="p">()</span> <span class="p">{</span>
        <span class="kt">DarwinNotificationManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">startObserving</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"com.yourapp.BroadcastStarted"</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">broadcastStatus</span> <span class="o">=</span> <span class="s">"Broadcasting..."</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"*******Broadcast has started*******"</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="kt">DarwinNotificationManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">startObserving</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"com.yourapp.BroadcastStopped"</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">broadcastStatus</span> <span class="o">=</span> <span class="s">"Not Broadcasting"</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"*******Broadcast has stopped*******"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">stopCallbacks</span><span class="p">()</span> <span class="p">{</span>
        <span class="kt">DarwinNotificationManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">stopObserving</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"com.yourapp.BroadcastStarted"</span><span class="p">)</span>
        <span class="kt">DarwinNotificationManager</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">stopObserving</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"com.yourapp.BroadcastStopped"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Like I had mentioned earlier, the observation is started in onAppear and the observation is stopped in onDisappear. This will make sure that your code doesn’t cause a memory leak.</p>

<h2 id="key-takeaways">Key Takeaways</h2>

<ol>
  <li>
    <p><strong>Inter-Process Communication</strong>: Darwin notifications provide a powerful mechanism for communication between different processes, such as between a main app and its extensions, overcoming the limitations of <code class="language-plaintext highlighter-rouge">NSNotificationCenter</code>.</p>
  </li>
  <li>
    <p><strong>System-Wide Reach</strong>: Unlike <code class="language-plaintext highlighter-rouge">NSNotificationCenter</code>, which is confined to a single app, Darwin notifications can be observed by any process on the device, making them ideal for app-extension communication.</p>
  </li>
  <li>
    <p><strong>No Payload Support</strong>: Darwin notifications do not support sending additional data (like a <code class="language-plaintext highlighter-rouge">userInfo</code> dictionary). They are limited to notifying observers of the occurrence of an event without additional context.</p>
  </li>
  <li>
    <p><strong>Efficient Notification Handling</strong>: By using <code class="language-plaintext highlighter-rouge">CFNotificationCenterGetDarwinNotifyCenter</code>, developers can efficiently post and observe notifications without the overhead of managing additional data.</p>
  </li>
  <li>
    <p><strong>SwiftUI Integration</strong>: Darwin notifications can be easily integrated into SwiftUI applications, allowing for real-time updates and state management across different app components.</p>
  </li>
</ol>

<h2 id="closing-thoughts">Closing thoughts</h2>

<p>My mind always compares these inter-process notifications to comets passing through our planet Earth. Just as comets are rare and awe-inspiring events that capture our attention, Darwin notifications serve as crucial signals that allow different parts of an app ecosystem to communicate seamlessly. Isn’t it a great analogy?</p>

<p>So, that is it. If you have read the blog till here, I really appreciate it. I hope this exploration of Darwin notifications has inspired you to think about inter-process communication in new ways. I can’t wait to see how you use Darwin notifications in your apps. Do let me know your thoughts and experiences in the comments below. Your feedback and ideas are always welcome! Also don’t forget to share this article with your network!</p>

<h2 id="references-to-darwin-notifications">References to Darwin Notifications</h2>

<ul>
  <li><a href="https://developer.apple.com/documentation/corefoundation/cfnotificationcenter">CFNotificationCenter Reference</a></li>
</ul>

<h3 id="about-the-author">About the author</h3>

<ul>
  <li><strong>Rizwan Ahmed</strong> - Senior iOS Engineer. 
<br /> LinkedIn - <a href="https://www.linkedin.com/in/rizwan95/">https://www.linkedin.com/in/rizwan95/</a>
<br /> Twitter - <a href="https://twitter.com/rizwanasifahmed">https://twitter.com/rizwanasifahmed</a></li>
</ul>

<h3 id="more-articles">More articles</h3>

<ul>
  <li><a href="/blog/2024/08/15/swiftui-in-2024-bridging-perception-and-reality/">SwiftUI in 2024: Bridging Perception and Reality</a></li>
  <li><a href="/blog/2023/12/01/from-viewwillappear-to-viewisappearing-perfecting-your-ios-view-transitions/">From viewWillAppear to viewIsAppearing - Perfecting Your iOS View Transitions</a></li>
  <li><a href="/blog/2023/06/19/exploring-the-new-push-notifications-console-from-apple/">Exploring the New Push Notifications Console from Apple</a></li>
  <li><a href="/blog/2023/05/28/testing-remote-push-notifications-in-ios-simulator-with-xcode-14/">How to send Remote Push Notifications to an iOS Simulator with Xcode 14</a></li>
  <li><a href="/blog/2023/05/26/how-to-instantly-track-a-variable-s-value-changes-with-xcode-watchpoints/">How to Instantly Track a Variable’s Value Changes with Xcode Watchpoints</a></li>
  <li><a href="/blog/2022/06/12/implementing-a-custom-native-calendar-using-uicalendarview-in-ios16-and-swift/">Implementing a custom native calendar using UICalendarView in iOS16 and Swift</a></li>
  <li><a href="/blog/2020/08/29/replacing-uiimagepickercontroller-with-phpickerviewcontroller/">Replacing UIImagePickerController with PHPickerViewController</a></li>
</ul>

  </div>
  <script defer src="https://comments.ohmyswift.com/comentario.js"></script>
<comentario-comments theme="light"></comentario-comments>
  <!-- <div class="container wrap">
<form method="post" action="https://newsletter.codeflakes.studio/subscription/form" class="listmonk-form">
    <div>
        <h2 class="centerstyle">OhMySwift Weekly</h2>
        <p class="centerstyle">Interested in learning or upgrading your skills as an iOS/macOS developer? Then this newsletter is for you. Published on Fridays. </p>
        <input type="hidden" name="nonce" />
        <p><input type="email" name="email" required placeholder="E-mail" /></p>
        <p><input type="text" name="name" placeholder="Name (optional)" /></p>
        <p hidden>
            <input id="d16d7" type="checkbox" name="l" checked value="d16d7a36-f48f-4edc-b743-7f2e6ca70478" />
            <label for="d16d7">OhMySwift Readers</label>
        </p>
        <p class="centerstyle">
            <button type="submit" class="button">Subscribe</button>
        </p>
        <p class="centerstyle">
            No spam, ever. We’ll never share your email address and you can opt out at any time.
        </p>

    </div>
</form>
</div>

 -->
  <div>
    <a class="notification sponsor" href="https://zoho.to/OMS" target="_blank">
    <img src="https://www.zohowebstatic.com/sites/zweb/images/productlogos/apptics.svg">
    <div>
    <p class= "sponsor-title">
        Zoho Apptics: Comprehensive, comparative, and concise product analytics
    </p>
    <p>
        Zoho Apptics gives you everything you need in one SDK and dashboard—crash reporting, in‑app feedback, push notifications, user segments, feature‑usage tracking, and user flows—so you can track metrics, visualize engagement, and optimize for growth without stitching data across tools.    </p>
    </div>
</a>
</div>
  <div class = "centerstyle">
    <p>Like our articles? Support us!</p>
 

    <script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="ohmyswift" data-color="#FFDD00" data-emoji="🍕"  data-font="Lato" data-text="Buy me a pizza" data-outline-color="#000000" data-font-color="#000000" data-coffee-color="#ffffff" ></script>


</div>

</article>


  
      </div>
    </main>

    <footer class="site-footer">
    <div class="wrapper">


      <p>
        

&copy;  - Powered by <a href="https://jekyllrb.com">Jekyll</a> &amp; <a href="https://github.com/yous/whiteglass">whiteglass</a> - Subscribe via <a href="https://ohmyswift.com/blog/feed.xml">RSS</a>

      </p>

    <div>
<script data-name="BMC-Widget" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="ohmyswift" data-description="Support me on Buy me a coffee!" data-message="Do you like our articles? Support us! Buy us a pizza" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18">
</script>
</div>
</footer>

  </body>

</html>
